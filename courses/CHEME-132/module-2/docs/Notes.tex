\documentclass[11pt]{article}

% load some asm stuff -
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
%\usepackage{palatino,lettrine}
\usepackage{fancyhdr}
\usepackage{epsfig}
\usepackage[square,sort,comma,numbers]{natbib}
\usepackage{simplemargins}
\usepackage{setspace}
\usepackage{wrapfig}
\usepackage{hyperref}
%\usepackage{boiboites}
\usepackage[margin=0pt,font=small,labelfont=bf]{caption}
\newcommand{\boldindex}[1]{\textbf{\hyperpage{#1}}}
\usepackage{makeidx}\makeindex
\bibliographystyle{plos2015}

\usepackage{algpseudocode}
\usepackage{algorithm}


% Set the size
%\textwidth = 6.75 in
%\textheight = 9.75 in
%\oddsidemargin = 0.0 in
%\evensidemargin = 0.0 in
%\topmargin = 0.01 in
%\headheight = 0.0 in
%\headsep = 0.25 in
%\parskip = 0.15in
% \doublespace
\setallmargins{1in}

\newtheorem{example}{Example}[section]
\newtheorem{thm}{Theorem}[section]
\newtheorem{property}{Property}[section]

\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}

\makeatletter
% \renewcommand\subsection{\@startsection
% 	{subsection}{2}{0mm}
% 	{-0.05in}
% 	{0.05\baselineskip}
% 	{\normalfont\normalsize\bfseries}}
\renewcommand\subsubsection{\@startsection
	{subsubsection}{2}{0mm}
	{-0.05in}
	{-0.5\baselineskip}
	{\normalfont\normalsize\itshape\bfseries}}
\renewcommand\paragraph{\@startsection
	{paragraph}{2}{0mm}
	{-0.05in}
	{-0.5\baselineskip}
	{\normalfont\normalsize\itshape}}
\makeatother
\linespread{1.1}

\fancypagestyle{proposal}{\fancyhf{}%
	\fancyhead[RO,LE]{\thepage}%
	\fancyhead[LO,RE]{CHEME 132 Module 2 Single Asset Geometric Brownian Motion}%
	\renewcommand\headrulewidth{1pt}}
\pagestyle{proposal}

\usepackage{mdframed}
\definecolor{lgray}{rgb}{0.92,0.92,0.92}
\definecolor{antiquewhite}{rgb}{0.98,0.92,0.84}
\definecolor{lightskyblue}{rgb}{0.93,0.95,0.99}

% defn environment
\mdfdefinestyle{theoremstyle}{% 
    linecolor=black,linewidth=1pt,% 
    frametitlerule=true,% 
    frametitlebackgroundcolor=lgray, 
    innertopmargin=\topskip,} 
\mdtheorem[style=theoremstyle]{definition}{Definition}

% concept environment
\mdfdefinestyle{conceptstyle}{% 
    linecolor=black,linewidth=1pt,% 
    frametitlerule=true,% 
    frametitlebackgroundcolor=lightskyblue, 
    innertopmargin=\topskip,} 
\mdtheorem[style=conceptstyle]{concept}{Concept}
\newcommand{\newterm}[1]{{\it #1}}

% Single space'd bib -
\setlength\bibsep{0pt}

\renewcommand{\rmdefault}{phv}\renewcommand{\sfdefault}{phv}
%\newboxedtheorem[boxcolor=black, background=gray!5,titlebackground=orange!20,titleboxcolor = black]{color_box_example}{Example}{test}

% Change the number format in the ref list -
\renewcommand{\bibnumfmt}[1]{#1.}

% Change Figure to Fig.
\renewcommand{\figurename}{Fig.}
\usepackage{enumitem}
\setlist{noitemsep} % or \setlist{noitemsep} to leave space around whole list

%Joycelyn Chan, Joshua Lequieu, Michael Paull, Chidanand Balaji, Ryan Tasseff
%Our derivation follows closely the earlier development of Fredrickson \citep{Fredrickson:1976fk}.

% Begin ...
\begin{document}

%\begin{titlepage}
{\par\centering\textbf{\Large CHEME 132 Module 2: Single Asset Geometric Brownian Motion Simulations}}
\vspace{0.2in}
{\par \centering \large{Jeffrey D. Varner}}
\vspace{0.05in}
{\par \centering \large{Smith School of Chemical and Biomolecular Engineering}}
{\par \centering \large{Cornell University, Ithaca NY 14853}}
% \vspace{0.1in}
% {\par \centering \small{Copyright \copyright\ Jeffrey Varner 2018. All Rights Reserved.}}\\

%\end{titlepage}
\date{}
\thispagestyle{empty}

\setcounter{page}{1}

\section*{Introduction}
\href{https://en.wikipedia.org/wiki/Geometric_Brownian_motion}{Geometric Brownian motion (GBM)} is a continuous-time stochastic model in which the random variable $S(t)$, 
e.g., the share price of a firm. 
Geometric Brownian motion was popularized as a financial model by Samuelson in the 1950s and 1960s \cite{Merton2006}, 
but is arguably most commonly associated with the Blackâ€“Scholes options pricing model, which we will describe later 
\cite{BlackScholes1973}. Let's start with the single asset case (in the absence of dividends), 
and then consider the multiple asset case in the next module.


Geometric Brownian motion (GBM) assumes that the share price $S(t)$ of a firm can be modeled as a detereministic
drift term (which is proportional to the share price) that is corrupted by a \href{https://en.wikipedia.org/wiki/Wiener_process}{Wiener noise process}, also proportional to the share price:
\begin{equation}\label{eqn:GBM}
\frac{dS}{S} = {\mu}\,dt + \sigma\,{dW}
\end{equation}
The constant $\mu$ denotes a drift parameter, i.e., the growth rate of the share price return, $\sigma$ is a volatility parameter, i.e., 
the dispersion of the return, $dt$ denotes an infinitesimal time step, and $dW$ is the output of a 
\href{https://en.wikipedia.org/wiki/Wiener_process}{Wiener noise process}.  A \href{https://en.wikipedia.org/wiki/Wiener_process)}{Wiener Process} 
(also often referred to as a standard Brownian motion) is a real-valued continuous-time stochastic 
process named after \href{https://en.wikipedia.org/wiki/Norbert_Wiener}{Norbert Wiener} for the study of one-dimensional Brownian motion (Defn. \ref{defn-wiener-process}):
\begin{definition}[Wiener Process]\label{defn-wiener-process}
A Wiener process is a continuous one-dimensional stochastic process $\left\{W\left(t\right), 0\leq{t}\leq{T}\right\}$ with the following properties:
\begin{itemize}
\setlength\itemsep{0em}
\item{W$\left(0\right)$ = $0$ with probability $1$}
\item{The increments $\left\{W(t_{1}) - W(t_{o}),\dots, W(t_{k}) - W(t_{k-1})\right\}$ are independent for any $k$ and $0\leq{t_{o}}< t_{1} < \dots < t_{k} \leq{T}$}
\item{The increment W(t) - W(s) $\sim~N\left(0,t-s\right)$ for any $0\leq{s}< t \leq{T}$, where $N\left(0,t-s\right)$ denotes a normally distributed random variable with mean $0$ and variance $t - s$.}
\end{itemize}
\end{definition}
Equation \ref{eqn:GBM} is a continuous-time analog of the discrete-time binomial lattice model we developed previously. 
It has several interesting properties, for example it has an analytical solution, and that solution is a lognormal distribution.
Futher, it has analytical expressions for the expectation and variance of the share price.
In this module, we will develop analytical solutions to Eqn. \ref{eqn:GBM}, and tools to estimate 
the parameters $\mu$ and $\sigma$ from historical data. We'll then use these tools to simulate the share price of firms.


\section*{Analytical solution}
Using Ito's lemma, we can formulate an analytical solution to the GBM equation for a single asset.
Ito's Lemma, developed by K. Ito in 1951, is an analog of the Taylor series for stochastic systems.
Let the random variable $X(t)$ be governed by the general stochastic differential equation:
\begin{equation*}
dX = a\left(X(t),t\right)dt + b\left(X(t),t\right)dW(t)
\end{equation*}
where $dW(t)$ is a one-dimensional Wiener process and $a$ and $b$ are functions of $X(t)$ and $t$. 
Let $Y(t) = \phi\left(t,X(t)\right)$ be twice differentiable with respect to $X(t)$, 
and singly differentiable with respect to $t$. Then, $Y(t)$ is governed by the equation:
\begin{equation*}
dY = \left(\frac{\partial{Y}}{\partial{t}}+a\frac{\partial{Y}}{\partial{X}}+\frac{b^{2}}{2}\frac{\partial^{2}{Y}}{\partial{X}^{2}}\right)dt+b\left(\frac{\partial{Y}}{\partial{X}}\right)dW(t)
\end{equation*}
Let $Y = \ln(S)$, $a = \mu\cdot{S}$, and $b = \sigma\cdot{S}$. 
Then, $Y$ is governed by the stochastic differential equation (using Ito's Lemma):
\begin{equation*}
d\ln(S) = \left(\mu - \frac{\sigma^{2}}{2}\right)dt + \sigma\cdot{dW(t)}
\end{equation*}
We integrate both sides of the equation to obtain from $t_{\circ}$ to $t$:
\begin{equation*}
\int_{t_{\circ}}^{t}d\ln(S) = \int_{t_{\circ}}^{t}\left(\mu - \frac{\sigma^{2}}{2}\right)dt + \int_{t_{\circ}}^{t}\sigma\cdot{dW(t)}
\end{equation*}
which gives:
\begin{equation*}
\ln\left(\frac{S_{t}}{S_{\circ}}\right) = \left(\mu - \frac{\sigma^{2}}{2}\right)\left(t - t_{\circ}\right) + \sigma\cdot\sqrt{t-t_{\circ}}\cdot{Z(0,1)}
\end{equation*}
where the noise term makes use of the definition of the integral of a Wiener process.
Finally, we exponentiate both sides of the equation to obtain the analytical solution to the GBM model:
\begin{equation}\label{eqn:analytical-soln-GBM}
S(t) = S_{\circ}\exp\Biggl[\left(\mu-\frac{\sigma^{2}}{2}\right)\left(t - t_{\circ}\right) + (\sigma\sqrt{t-t_{\circ}})\cdot{Z_{t}(0,1)}\Biggr]
\end{equation}
where $S_{\circ}$ denotes the share price at $t_{\circ}$, and $Z_{t}(0,1)$ denotes a 
\href{https://en.wikipedia.org/wiki/Normal_distribution#Standard_normal_distribution}{standard normal random variable} at time $t$.
The expectation and variance of the GBM model is given by:
\begin{eqnarray*}
\mathbb{E}\left(S_{t}\right) &=& S_{o}\cdot\exp\left(\mu\cdot\Delta{t}\right)\\
\text{Var}\left(S_{t}\right) &=& S_{\circ}^{2}e^{2\mu\cdot\Delta{t}}\left[e^{\sigma^{2}{\Delta{t}}} - 1\right]
\end{eqnarray*}
where $\Delta{t} = t - t_{\circ}$.

\section*{Model parameters}
\subsection*{Estimating the drift parameter $\mu$}
Let's assume that we have a time series of share price values $S(t_{1}), S(t_{2}), \dots, S(t_{k})$ and we want to estimate the detereministic growth of the share price, i.e., the drift parameter $\mu$.
There are several ways to do this, but we will use a detereministic linear model of the natural log of the share price values.
To estimate the deterministic component of the share price, we first set the volatility parameter $\sigma = 0$ in Eqn. \ref{eqn:analytical-soln-GBM}.
Then, at some future time $t$, the share price (after some algebra) is given by:
\begin{equation}\label{eqn:log-share-price-linear-model}
\ln\,S_{i} = \ln\,S_{\circ} + \mu\cdot\left(t_{i}-t_{\circ}\right)
\end{equation}
where $\ln\,S_{\star}$ denotes the natural log of the share price at time $t_{\star}$.
Equation \ref{eqn:log-share-price-linear-model} is a linear model of the form $y = mx + b$, where $y = \ln\,S_{i}$, $x = t_{i}-t_{\circ}$, $m = \mu$, and $b = \ln\,S_{\circ}$.
Thus, we can estimate the growth parameter $\mu$ by fitting a linear model to the log of the share price values by solving an overdetermined system of linear equations.

Let $\mathbf{A}$ denote a $\mathcal{S}\times{2}$ matrix, where each row corresponds to a time value $t>0$. 
The first column of $\mathbf{A}$ is all 1's while the second column holds the $(t_{k}-t_{\circ})$ values. 
Further, let $\mathbf{Y}$ denote the natural log of the share price values (in the same temperal order as the $\mathbf{A}$ matrix). 
Then, the y-intercept and slope (drift parameter) can be estimated by solving the overdetermined system of equations:
\begin{equation*}
\mathbf{A}\mathbf{\theta} + \mathbf{\epsilon} = \mathbf{Y}
\end{equation*}
where $\mathbf{\theta}$ denotes the vector of unknown parameters (the y-intercept and slope), and $\mathbf{\epsilon}$ denotes an error model, e.g., a normal distribution with mean zero and variance $\sigma_{\epsilon}^{2}$.
This system can be solved as:
\begin{equation*}
\mathbf{\theta} = (\mathbf{A}^{T}\mathbf{A})^{-1}\mathbf{A}^{T}\mathbf{Y} - (\mathbf{A}^{T}\mathbf{A})^{-1}\mathbf{A}^{T}\mathbf{\epsilon}
\end{equation*}
where $\mathbf{A}^{T}$ denotes the transpose of the matrix $\mathbf{A}$, and $(\mathbf{A}^{T}\mathbf{A})^{-1}$ denotes the inverse of the square matrix product $\mathbf{A}^{T}\mathbf{A}$. 
Finally, we can estimate the error term $\mathbf{\epsilon}$ by calculating the residuals:
\begin{equation*}
\mathbf{\epsilon} = \mathbf{Y} - \mathbf{A}\mathbf{\theta}
\end{equation*}
and then fitting a normal distribution to the residuals, using some technique such as maximum likelihood estimation, to compute the uncertainty in the estimate of the drift parameter $\hat{\mu}$ 
(where the $\hat{\star}$ denotes an estimate of the parameter).

\subsection*{Estimating the volatility parameter $\sigma$}
Generally, methods to calculate the volatility parameter can be classified into two categories - historical volatility estimates based on past return data and future volatility 
estimates based on the \href{https://en.wikipedia.org/wiki/Implied_volatility}{Implied Volatility (IV)} of \href{https://en.wikipedia.org/wiki/Option_(finance)}{options contracts}. 
Here, we estimate the volatility $\sigma$ from historical data.

\section*{Summary}
Fill me in.

\bibliography{References_v1}

\clearpage
\printindex

\end{document}
